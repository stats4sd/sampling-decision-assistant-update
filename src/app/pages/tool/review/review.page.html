<ion-header>
  <ion-navbar color="primary">
    <ion-title>Review and Analysis</ion-title>
  </ion-navbar>
</ion-header>

<ion-content class="slide-scroll-content survey" style="margin-bottom:10px">
  <ion-content>
    <!-- Review content -->
    <div padding id="reviewContent">
      <h2>Review Decisions</h2>
      <div>
        <div *ngFor="let group of questionGroups" class="section-group">
          <div class="heading">
            {{group.section}}
          </div>
          <div
            *ngFor="let question of group.questions"
            class="section-question"
          >
            <survey-question
              *ngIf="!question.repeatGroup && !question.hideOnReview"
              [question]="question"
              [reviewMode]="true"
            ></survey-question>
          </div>
          <div [ngSwitch]="group.section">
            <!-- additional group-specific content -->
            <div
              *ngSwitchCase="'At what level do you need to report these results'"
            >
              <ion-card class="container">
                <stage-4-define-level-categories
                  [reviewMode]="true"
                ></stage-4-define-level-categories>
              </ion-card>
            </div>
            <div *ngSwitchCase="'Selecting the sampling units'">
              <ion-card class="container">
                <stage-5-frame-builder-overview
                  [reviewMode]="true"
                ></stage-5-frame-builder-overview>
              </ion-card>
            </div>
            <div *ngSwitchCase="'Allocating and deploying resources'">
              <tree-diagram></tree-diagram>
              <div class="section-padding"></div>
              <sample-size-calculator></sample-size-calculator>
              <div class="section-padding"></div>
              <tree-table></tree-table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Analysis Content -->
    <div padding>
      <h2>Export</h2>
      <div style="display: flex; flex-wrap: wrap  ">
        <button
          ion-button
          icon-left
          (click)="exportJSON()"
          class="export-button"
        >
          <ion-icon name="custom-database"></ion-icon>Project Data
        </button>
        <!-- <button ion-button icon-left (click)="exportXLSX()" class="export-button" >
          <ion-icon name="custom-excel"></ion-icon>XLSX Summary</button> -->
        <button
          ion-button
          icon-left
          (click)="exportDocx()"
          class="export-button"
        >
          <ion-icon name="custom-word"></ion-icon>Summary
        </button>
        <button
          ion-button
          icon-left
          (click)="exportTreeImage()"
          class="export-button"
        >
          <ion-icon name="custom-tree"></ion-icon>Diagram
        </button>
      </div>
    </div>
  </ion-content></ion-content
>
